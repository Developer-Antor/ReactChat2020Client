(this.webpackJsonpmyapp=this.webpackJsonpmyapp||[]).push([[0],{58:function(e,t,c){},59:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},75:function(e,t,c){"use strict";c.r(t);var a=c(5),n=c(2),s=c(26),o=c.n(s),i=c(15),r=c(31),d=c(10),l=(c(58),c(49)),u=c.n(l),j=(c(59),c(35)),m=j.a.initializeApp({apiKey:"AIzaSyCWITDBqlWNHajkbzQYvTKnaoeXo4tpM7o",authDomain:"whatsapp-clone-840ac.firebaseapp.com",projectId:"whatsapp-clone-840ac",storageBucket:"whatsapp-clone-840ac.appspot.com",messagingSenderId:"217993161224",appId:"1:217993161224:web:6d5deab2d11939795d7fbd"}),b=m.firestore(),h=m.auth(),p=new j.a.auth.GoogleAuthProvider,O=b,f=Object(n.createContext)(),v=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(a.jsx)(f.Provider,{value:Object(n.useReducer)(t,c),children:s})},x=function(){return Object(n.useContext)(f)},g=c(91);var S=function(){var e,t,c=Object(n.useState)(""),s=Object(i.a)(c,2),o=s[0],r=s[1],l=Object(n.useState)([]),m=Object(i.a)(l,2),b=m[0],h=m[1],p=x(),f=Object(i.a)(p,2),v=f[0].user,S=(f[1],Object(d.e)().roomId),N=Object(n.useState)(""),y=Object(i.a)(N,2),w=y[0],C=y[1];return Object(n.useEffect)((function(){S&&(O.collection("rooms").doc(S).onSnapshot((function(e){C(e.data().name)})),O.collection("rooms").doc(S).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){h(e.docs.map((function(e){return e.data()})))})))}),[S]),console.log(b),Object(a.jsxs)("div",{className:"chat",children:[Object(a.jsxs)("div",{className:"chat-header",children:[Object(a.jsx)(g.a,{onClick:function(){document.querySelector(".chat").classList.remove("show")}}),Object(a.jsx)("h2",{children:w}),Object(a.jsxs)("p",{children:["Last seen at",new Date(null===(e=b[b.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(a.jsx)("div",{className:"chat-body",children:b.map((function(e){var t;return Object(a.jsxs)("p",{className:"chat-message ".concat(e.name===v.displayName&&"chat-reciever"),children:[Object(a.jsx)("span",{className:"chat-name",children:e.name}),e.message,Object(a.jsx)("span",{className:"chat-timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(a.jsxs)("form",{className:"chat-footer",children:[Object(a.jsx)("input",{value:o,onChange:function(e){r(e.target.value)},type:"text",placeholder:"Write a message"}),Object(a.jsx)("button",{onClick:function(e){e.preventDefault(),O.collection("rooms").doc(S).collection("messages").add({message:o,name:v.displayName,timestamp:j.a.firestore.FieldValue.serverTimestamp()}),r("")},type:"submit",children:Object(a.jsx)(u.a,{})})]})]})},N=c(92),y=c(43),w="SET_USER";c(71);var C=function(){var e=x(),t=Object(i.a)(e,2),c=(t[0].user,t[1]);return Object(a.jsx)("div",{className:"login",children:Object(a.jsx)(N.a,{style:{color:"#fff",background:"#000"},onClick:function(){h.signInWithPopup(p).then((function(e){c({type:w,user:e.user})})).catch((function(e){alert(e.message)}))},children:"Sign In"})})},I=(c(72),c(93)),k=(c(73),c.p+"static/media/undraw_profile_pic_ic5t (1).19cef30a.png");var D=function(e){var t,c=e.addNewChat,s=e.name,o=e.id,d=Object(n.useState)([]),l=Object(i.a)(d,2),u=l[0],j=l[1];return Object(n.useEffect)((function(){return o&&O.collection("rooms").doc(o).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){j(e.docs.map((function(e){return e.data()})))})),function(){}}),[o]),c?Object(a.jsx)("div",{onClick:function(){var e=prompt("Please enter a name for room");e&&O.collection("rooms").add({name:e})},className:"add sidebar-chat",children:Object(a.jsx)("h2",{children:"Add New Room"})}):Object(a.jsx)(r.b,{to:"/rooms/".concat(o),children:Object(a.jsxs)("div",{onClick:function(){document.querySelector(".chat").classList.add("show")},className:"sidebar-chat",children:[Object(a.jsx)(I.a,{src:k}),Object(a.jsxs)("div",{className:"sidebar-chat-info",children:[Object(a.jsx)("h2",{children:s}),Object(a.jsx)("p",{children:null===(t=u[0])||void 0===t?void 0:t.message})]})]})})};var T=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],o=x(),r=Object(i.a)(o,2),d=r[0].user;return r[1],console.log(d.uid),Object(n.useEffect)((function(){O.collection("rooms").onSnapshot((function(e){s(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),Object(a.jsxs)("div",{className:"sidebar",children:["5Ifr9Tmo5dSH1YLUmPypS3LuCXg1"===d.uid?Object(a.jsx)(D,{addNewChat:!0}):null,c.map((function(e){return Object(a.jsx)(D,{id:e.id,name:e.data.name},e.id)}))]})};var E=function(){var e=x(),t=Object(i.a)(e,2),c=t[0].user;return t[1],Object(a.jsx)("div",{className:"app",children:c?Object(a.jsx)("div",{className:"app-body",children:Object(a.jsxs)(r.a,{children:[Object(a.jsx)(d.a,{path:"/",children:Object(a.jsx)(T,{className:"mysidebar"})}),Object(a.jsx)(d.a,{exact:!0,path:"/rooms/:roomId",children:Object(a.jsx)(S,{})})]})}):Object(a.jsx)(C,{})})};o.a.render(Object(a.jsx)(v,{initialState:{user:null,username:null},reducer:function(e,t){switch(t.type){case w:return Object(y.a)(Object(y.a)({},e),{},{user:t.user});default:return e}},children:Object(a.jsx)(E,{})}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.aa33b06c.chunk.js.map